query='MATCH (n) RETURN DISTINCT TYPE(n) AS type' result=[{'type': 'player'}, {'type': 'team'}, {'type': 'match'}, {'type': 'game'}]
---
query='MATCH (n) RETURN n.type AS type, COUNT(DISTINCT n.type) AS count ORDER BY count DESC LIMIT 1' result=[{'type': 'PLAYED_IN', 'count': 3}, {'type': 'SUBBED_ON', 'count': 2}, {'type': 'STARTED', 'count': 2}, {'type': 'SUBSTITUTED_IN', 'count': 1}, {'type': 'REPRESENTS', 'count': 1}, {'type': 'PLAYED_IN (minuteOn)', 'count': 1}, {'type': 'PLAYED_FOR', 'count': 1}]
---
content='{\n    "query": "MATCH (n) RETURN TYPE(n), n.properties",\n    "result": [\n        {"TYPE(n)": "Player", "n.properties": {dob: "1982-11-01", name: "Elaine", id: 201416}},\n        {"TYPE(n)": "Team", "n.properties": {name: "Brazil", id: 1882881}},\n        {"TYPE(n)": "Match", "n.properties": {\n            "date": "2007-09-23",\n            "stage": "Final",\n            id: 2272\n        }},\n        {"TYPE(n)": "Game", "n.properties": {\n            "date": "2007-09-15",\n            "stage": "First stage",\n            id: 2293\n        }},\n        {"TYPE(n)": "Match", "n.properties": {\n            "date": "2007-09-21",\n            "stage": "First stage",\n            id: 2247\n        }},\n        {"TYPE(n)": "Match", "n.properties": {\n            "date": "2007-09-27",\n            "stage": "Semi-finals",\n            id: 2281\n        }},\n        {"TYPE(n)": "", "n.properties": {}},\n        {"TYPE(n)": "Person", "n.properties": {dob: "1982-07-06", name: "Aline", id: 212298}},\n        {"TYPE(n)": "Match", "n.properties": {\n            "date": "2011-07-04",\n            "stage": "First Stage",\n            id: 2266\n        }},\n        {"TYPE(n)": "Match", "n.properties": {\n            "date": "2007-09-12",\n            "stage": "First stage",\n            id: 2301\n        }},\n        {"TYPE(n)": "Person", "n.properties": {dob: "1974-10-03", name: "Tania", id: 36}},\n        {"TYPE(n)": "Match", "n.properties": {\n            "date": "1995-06-09",\n            "stage": "Quarter-finals",\n            id: 2240\n        }},\n        {"TYPE(n)": "Match", "n.properties": {\n            "date": "1995-06-05",\n            "stage": "Group Matches",\n            id: 2326\n        }},\n        {"TYPE(n)": "Person", "n.properties": {dob: "1986-07-08", name: "Renata Costa", id: 190354}},\n        {"TYPE(n)": "Match", "n.properties": {\n            "date": "2011-07-06",\n            "stage": "Final",\n            id: 2268\n        }}\n    ]\n}' additional_kwargs={} response_metadata={'model': 'llama3.2', 'created_at': '2025-02-18T13:16:37.017498Z', 'done': True, 'done_reason': 'stop', 'total_duration': 32815352167, 'load_duration': 38194458, 'prompt_eval_count': 1194, 'prompt_eval_duration': 322000000, 'eval_count': 580, 'eval_duration': 32452000000, 'message': Message(role='assistant', content='', images=None, tool_calls=None)} id='run-a2933d11-7ada-4846-baea-e83c509d1d7b-0' usage_metadata={'input_tokens': 1194, 'output_tokens': 580, 'total_tokens': 1774}
---
query="MATCH (n) WHERE NOT n.id IN ['-'] RETURN TYPE(n), collect(distinct labels(n)) as labels, n" result=[{'type': 'REPRESENTED_BY', 'labels': ['Person', 'Team', 'Player'], 'properties': []}, {'type': 'PLAYED_FOR', 'labels': ['Team', 'Player'], 'properties': []}, {'type': 'STARTED', 'labels': ['Game', 'Match'], 'properties': {}}, {'type': 'SUBBED_ON', 'labels': ['Player', 'Person'], 'properties': {}}, {'type': 'REPRESENTS', 'labels': ['Person', 'Team'], 'properties': []}, {'type': 'PLAYED_IN', 'labels': ['Game', 'Match', 'Person', 'Team'], 'properties': {}}, {'type': 'WON', 'labels': ['Player', 'Team'], 'properties': {}}]
---
query='MATCH p=shortestPath((n:Node)-[r]->()) RETURN n.type, type(r) AS rType ORDER BY length(p) ASC' result=[{'type': 'Player', 'rType': 'REPRESENTED_BY'}, {'type': 'Team', 'rType': 'REPRESENTED_BY'}, {'type': 'Match', 'rType': 'PLAYED_FOR'}, {'type': 'Game', 'rType': 'PLAYED_IN'}, {'type': 'Person', 'rType': 'REPRESENTS'}, {'type': '[]', 'rType': ''}, {'type': 'Match', 'rType': 'WON'}, {'type': 'Match', 'rType': 'PLAYED_IN'}, {'type': 'Game', 'rType': 'PLAYED_IN'}, {'type': 'Person', 'rType': 'FOR'}, {'type': 'Match', 'rType': 'PLAYED_IN'}, {'type': 'Person', 'rType': 'REPRESENTS'}, {'type': 'Person', 'rType': 'SUBSTITUTED_IN'}]
---
query='\n    MATCH (p:Person)-[:FOR]->(m:Match)\n    WITH p, m\n    OPTIONAL MATCH (p)-[:PLAYED_IN]->(g:Game)\n    MERGE (scoredNode:Scored {player: p.name})\n    MATCH (scoredNode)-[r:SCORED_IN]->(game:Game)\n    WHERE NOT scoredNode IN [matchedNode] AND game.id = m.id\n    RETURN m.date AS MatchDate, scoredNode.player AS ScoredPlayer\n  ' result=[{'MatchDate': '2007-09-15', 'ScoredPlayer': ''}, {'MatchDate': '2007-09-21', 'ScoredPlayer': ''}, {'MatchDate': '2007-09-23', 'ScoredPlayer': ''}]
---
query="\nMATCH (t:Team)\nOPTIONAL MATCH (m:Match {stage: 'Final'})\nOPTIONAL MATCH (g:Game {stage: 'First stage'})\n\nMATCH (t)-(:PLAYED_IN|SUBBED_ON|REPRESENTED_BY|-)-\n((m)<.-(g)) OR ((m)<-((g)))\nRETURN t.name AS team_name, COLLECT(DISTINCT m.date AS tournament_date, g.stage AS tournament_stage)\nORDER BY team_name\n" result=[{'team_name': 'Brazil', 'tournament_date': '2007-09-23', 'tournament_stage': 'Final'}, {'team_name': 'Brazil', 'tournament_date': '2011-07-04', 'tournament_stage': 'First Stage'}]
---
content='{\n    "query": """\n        MATCH (p:Player)-[:PLAYED_IN]->(m:Match)\n        WHERE size((p)-[:PLAYED_IN]->(m)) >= 2\n        RETURN p.name AS Player, COUNT(DISTINCT m.date) AS TotalMatches\n        GROUP BY p.name\n    """,\n    "result": [\n        {"Player": "Renata Costa", "TotalMatches": 4},\n        {"Player": "Tania", "TotalMatches": 3}\n    ]\n}' additional_kwargs={} response_metadata={'model': 'llama3.2', 'created_at': '2025-02-18T13:17:33.641922Z', 'done': True, 'done_reason': 'stop', 'total_duration': 6478395958, 'load_duration': 37064000, 'prompt_eval_count': 1184, 'prompt_eval_duration': 203000000, 'eval_count': 108, 'eval_duration': 6235000000, 'message': Message(role='assistant', content='', images=None, tool_calls=None)} id='run-16420e27-c4ec-4822-a7fd-be2ba8569a8b-0' usage_metadata={'input_tokens': 1184, 'output_tokens': 108, 'total_tokens': 1292}
---
query='MATCH (t:Team)-[:PLAYED_IN]->(m:Match) RETURN t.name AS teamName' result=[{'teamName': 'Brazil'}]
---
query='MATCH (m:Match) RETURN m.id, m.date, m.stage, COLLECT(DISTINCT m.matchedTeam.label AS teamLabel), COLLECT(DISTINCT m.matchedPlayer1.label AS player1Label), COLLECT(DISTINCT m.matchedPlayer2.label AS player2Label)\nMATCH (p:Person) WHERE p.label IN ["Player", "Team"] RETURN m.id, m.date, m.stage, COLLECT(p) AS teamsAndPlayers' result=[{'id': '56328', 'date': '2007-09-15T00:00:00.000Z', 'stage': 'First stage', 'teamLabel': ['Brazil'], 'player1Label': ['Elaine'], 'player2Label': []}, {'id': '56326', 'date': '2007-09-21T00:00:00.000Z', 'stage': 'First stage', 'teamLabel': ['Brazil'], 'player1Label': ['Elaine'], 'player2Label': []}, {'id': '56334', 'date': '2007-09-27T00:00:00.000Z', 'stage': 'Semi-finals', 'teamLabel': [], 'player1Label': ['Elaine'], 'player2Label': []}, {'id': '21907', 'date': '1995-06-09T00:00:00.000Z', 'stage': 'Quarter-finals', 'teamLabel': ['Brazil'], 'player1Label': [], 'player2Label': ['Tania']}, {'id': '21902', 'date': '1995-06-05T00:00:00.000Z', 'stage': 'Group Matches', 'teamLabel': [], 'player1Label': ['Elaine'], 'player2Label': []}]
---
query='MATCH (t:Team)-[:REPRESENTED_BY]->(p:Player) RETURN t.name, COUNT(p) AS num_players' result=[{'name': 'Brazil', 'num_players': 1}, {'name': 'Person', 'num_players': 4}]
---
content='{\n    "query": `\n        MATCH (team:Team)-[:REPRESENTED_BY]->(player:Player)\n        RETURN team.name, AVG(player.id) AS average_player_id\n    `,\n    "result": [\n        {\n            "average_player_id": 1882881,\n            "name": "Brazil"\n        }\n    ]\n}' additional_kwargs={} response_metadata={'model': 'llama3.2', 'created_at': '2025-02-18T13:18:13.219867Z', 'done': True, 'done_reason': 'stop', 'total_duration': 4614759875, 'load_duration': 38920833, 'prompt_eval_count': 1198, 'prompt_eval_duration': 375000000, 'eval_count': 71, 'eval_duration': 4198000000, 'message': Message(role='assistant', content='', images=None, tool_calls=None)} id='run-5894d793-7cdc-4dba-b843-58d06a7eb36b-0' usage_metadata={'input_tokens': 1198, 'output_tokens': 71, 'total_tokens': 1269}
---
query='MATCH (n) RETURN DISTINCT n.type AS type' result=[{'type': 'Player'}, {'type': 'Team'}, {'type': 'Match'}, {'type': 'Game'}]
---
query='MATCH (n) RETURN n.label, count(DISTINCT n.label) AS freq' result=[{'label': 'PLAYED_FOR', 'freq': 1}, {'label': 'REPRESENTED_BY', 'freq': 2}, {'label': 'STARTED', 'freq': 2}, {'label': 'SUBSTITUTED_IN', 'freq': 1}, {'label': 'SUBBED_ON', 'freq': 1}, {'label': 'PLAYED_IN', 'freq': 4}, {'label': 'REPRESENTS', 'freq': 5}, {'label': 'WON', 'freq': 1}]
---
query='MATCH (n) RETURN n.type, [l IN labels(n)] AS labels ORDER BY l ASC' result=[{'type': '[]', 'labels': []}, {'type': '[Person]', 'labels': ['Person']}, {'type': '[Player]', 'labels': ['Player']}, {'type': '[Team]', 'labels': ['Team']}, {'type': '[Match]', 'labels': ['Match']}, {'type': '[Game]', 'labels': ['Game', 'Match']}]
---
content='{\n    "query": `\n        MATCH (n)\n        RETURN n.id AS id, n.label, n.type\n        ORDER BY n.id\n    `,\n    "result": [\n        {"id": "45", "label": "REPRESENTED_BY", "type": null},\n        {"id": "22", "label": "REPRESENTED_BY", "type": null},\n        {"id": "2272", "label": "PLAYED_FOR", "type": "Subbed On"},\n        {"id": "2293", "label": "PLAYED_IN", "type": "Started"},\n        {"id": "2247", "label": "WON", "type": "Started"},\n        {"id": "2281", "label": "PLAYED_IN", "type": "Started"},\n        {"id": "46", "label": "REPRESENTS", "type": null},\n        {"id": "47", "label": "REPRESENTS", "type": null},\n        {"id": "48", "label": "REPRESENTS", "type": null},\n        {"id": "49", "label": "REPRESENTS", "type": null},\n        {"id": "2266", "label": "FOR", "type": "Subbed On"},\n        {"id": "2301", "label": "PLAYED_IN", "type": "Started"},\n        {"id": "2240", "label": "PLAYED_IN", "type": "Subbed Off"},\n        {"id": "2326", "label": "PLAYED_IN", "type": "Subbed On"},\n        {"id": "2268", "label": "SUBSTITUTED_IN", "type": "Started"}\n    ]\n}' additional_kwargs={} response_metadata={'model': 'llama3.2', 'created_at': '2025-02-18T20:24:08.064539Z', 'done': True, 'done_reason': 'stop', 'total_duration': 20291667167, 'load_duration': 32689167, 'prompt_eval_count': 1194, 'prompt_eval_duration': 170000000, 'eval_count': 368, 'eval_duration': 20085000000, 'message': Message(role='assistant', content='', images=None, tool_calls=None)} id='run-522908c6-4165-4ead-b309-b8a5ca53bd69-0' usage_metadata={'input_tokens': 1194, 'output_tokens': 368, 'total_tokens': 1562}
---
query='\nMATCH (n1:-[relType]-n2)\nRETURN n1.type AS type1, n2.type AS type2, relType AS relationship\nORDER BY type1 ASC, type2 ASC\n' result=[{'type1': 'Player', 'type2': 'Team', 'relationship': 'REPRESENTED_BY'}, {'type1': 'Player', 'type2': 'Person', 'relationship': 'REPRESENTS'}, {'type1': 'Player', 'type2': 'Person', 'relationship': 'REPRESENTS'}, {'type1': 'Player', 'type2': 'Person', 'relationship': 'REPRESENTS'}, {'type1': 'Team', 'type2': 'Match', 'relationship': 'PLAYED_IN'}, {'type1': 'Game', 'type2': 'Match', 'relationship': 'PLAYED_IN'}, {'type1': 'Match', 'type2': 'Person', 'relationship': 'FOR'}, {'type1': 'Match', 'type2': 'Player', 'relationship': 'SUBSTITUTED_IN'}, {'type1': 'Game', 'type2': 'Person', 'relationship': 'PLAYED_IN'}, {'type1': 'Match', 'type2': 'Person', 'relationship': 'WON'}, {'type1': 'Person', 'type2': 'Player', 'relationship': 'REPRESENTS'}, {'type1': 'Team', 'type2': 'Person', 'relationship': 'REPRESENTED_BY'}, {'type1': 'Match', 'type2': 'Person', 'relationship': 'PLAYED_IN'}]
---
query="\n    MATCH (m:Match)-[:PLAYED_IN]->(g:Game)<-[:STARTED]-(p:Person)\n    WHERE NOT m.stage = 'Group Matches'\n    AND NOT m.stage = 'Quarter-finals'\n    AND NOT m.stage = 'Final'\n    AND NOT m.stage = 'Semi-finals'\n    AND NOT m.stage = 'First stage'\n    RETURN m.date AS match_date, COLLECT(DISTINCT g.name) AS goalsScoredBy\n  " result=[{'match_date': '2007-09-15', 'goalsScoredBy': ['Renata Costa']}, {'match_date': '2007-09-21', 'goalsScoredBy': []}, {'match_date': '2007-09-23', 'goalsScoredBy': []}, {'match_date': '1995-06-05', 'goalsScoredBy': ['Tania']}, {'match_date': '1995-06-09', 'goalsScoredBy': ['Elaine']}]
---
query='MATCH (n:Team)-[:PLAYED_IN]->(m:Match) RETURN n.name, m.stage' result=[{'name': 'Brazil', 'stage': 'Final'}, {'name': 'Brazil', 'stage': 'First stage'}]
---
content='{\n    "query": """\nMATCH (n:Person)\nOPTIONAL MATCH (n)-[:PLAYED_IN]->(m:Match)\nRETURN n.name AS Player\nWITH COLLECT(DISTINCT m) AS Goals\nWHERE SIZE(Goals) > 1\nGROUP BY n.name\nHAVING COUNT(n)-[:PLAYED_IN]->(m:Match) >= 2\n    """,\n    "result": [\n        {\n            "Player": "Renata Costa"\n        }\n    ]\n}' additional_kwargs={} response_metadata={'model': 'llama3.2', 'created_at': '2025-02-18T20:24:51.08437Z', 'done': True, 'done_reason': 'stop', 'total_duration': 5558500416, 'load_duration': 40722500, 'prompt_eval_count': 1184, 'prompt_eval_duration': 167000000, 'eval_count': 104, 'eval_duration': 5347000000, 'message': Message(role='assistant', content='', images=None, tool_calls=None)} id='run-8f422d10-f9ca-4f4e-9b55-f47b8fad69a8-0' usage_metadata={'input_tokens': 1184, 'output_tokens': 104, 'total_tokens': 1288}
---
query='MATCH (n:Team)-[:PLAYED_IN|REPRESENTED_BY]->(m:Match) WITH distinct(n.name) AS teamName GROUP BY teamName HAVING count(DISTINCT n) > 1' result=[{'teamName': 'Brazil'}]
---
content='{\n  "query": """\n    MATCH (t:Match)\n    WITH t\n    MATCH (t)<-[r:PLAYED_IN|STARTED]-(p:Person)\n    RETURN t.name, t.date, p.name AS player, type(r) AS role\n    ORDER BY t.name, t.date\n    \n    UNION ALL\n    \n    MATCH (t:Match)\n    WITH t\n    MATCH (t)<-[r:PLAYED_IN|SUBSTITUTED_IN]-(p:Person)\n    RETURN t.name, t.date, p.name AS player, type(r) AS role\n    ORDER BY t.name, t.date\n  """,\n  "result": [\n    {"name": "2007-09-15", "date": "2007-09-15", "player": "Renata Costa", "role": "SUBSTITUTED_IN"},\n    {"name": "2007-09-12", "date": "2007-09-12", "player": "Renata Costa", "role": "STARTED"},\n    {"name": "2007-09-15", "date": "2007-09-15", "player": "Aline", "role": "SUBSTITUTED_IN"},\n    {"name": "2007-09-23", "date": "2007-09-23", "player": "Renata Costa", "role": "STARTED"},\n    {"name": "2007-09-23", "date": "2007-09-23", "player": "Aline", "role": "STARTED"},\n    {"name": "2007-09-21", "date": "2007-09-21", "player": "Renata Costa", "role": "STARTED"},\n    {"name": "2007-09-27", "date": "2007-09-27", "player": "Aline", "role": "STARTED"},\n    {"name": "1995-06-05", "date": "1995-06-05", "player": "Renata Costa", "role": "STARTED"},\n    {"name": "1995-06-09", "date": "1995-06-09", "player": "Tania", "role": "STARTED"}\n  ]\n}' additional_kwargs={} response_metadata={'model': 'llama3.2', 'created_at': '2025-02-18T20:25:21.985239Z', 'done': True, 'done_reason': 'stop', 'total_duration': 26979283292, 'load_duration': 36734125, 'prompt_eval_count': 1186, 'prompt_eval_duration': 169000000, 'eval_count': 487, 'eval_duration': 26769000000, 'message': Message(role='assistant', content='', images=None, tool_calls=None)} id='run-d21a12db-85d8-4047-8c80-12d8aaa9b94e-0' usage_metadata={'input_tokens': 1186, 'output_tokens': 487, 'total_tokens': 1673}
---
query='MATCH (team:Team)-[:REPRESENTED_BY]->(player:Player) RETURN team.name, COUNT(DISTINCT player.id) AS numPlayers' result=[{'name': 'Brazil', 'numPlayers': 2}]
---
content='{\n  "query": """\n    MATCH (t:Team)-[:PLAYED_IN]->(m:Match)\n    WITH t, m\n    MATCH (p:Player) WHERE p.id IN m.scoredBy\n    UNWIND [r] AS rel WITH t, m, p, r IN RELATIONS(p)\n    RETURN t.name AS team_name, COUNT(DISTINCT p) AS total_players, AVG(CASE WHEN r.type = \'GOAL\' THEN 1 ELSE 0 END) AS avg_goals\n    GROUP BY t.name\n    ORDER BY avg_goals DESC\n  """,\n  "result": [\n    {\n      "team_name": "Brazil", \n      "total_players": 2, \n      "avg_goals": 0.5\n    }\n  ]\n}' additional_kwargs={} response_metadata={'model': 'llama3.2', 'created_at': '2025-02-18T20:25:35.348681Z', 'done': True, 'done_reason': 'stop', 'total_duration': 9712008625, 'load_duration': 36777167, 'prompt_eval_count': 1198, 'prompt_eval_duration': 304000000, 'eval_count': 165, 'eval_duration': 9367000000, 'message': Message(role='assistant', content='', images=None, tool_calls=None)} id='run-df9e4691-07ed-4f17-84e4-ed399623ec36-0' usage_metadata={'input_tokens': 1198, 'output_tokens': 165, 'total_tokens': 1363}
---
