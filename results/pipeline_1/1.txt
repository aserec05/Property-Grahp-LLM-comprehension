query='MATCH (n) RETURN DISTINCT labels(n) AS NodeLabels' result=[{'NodeLabels': '[Player]'}, {'NodeLabels': '[Team]'}, {'NodeLabels': '[Match]'}, {'NodeLabels': '[Game]'}, {'NodeLabels': ''}, {'NodeLabels': '[Person]'}]
---
query='MATCH (p:Person)-[:SCORED_GOAL]->(m:Match) RETURN m, collect(p) AS Players' result=[{'date': '2007-09-23', 'stage': 'Final', 'id': 2272, 'Players': [{'dob': '1982-07-06', 'name': 'Aline', 'id': 212298}, {'dob': '1974-10-03', 'name': 'Tania', 'id': 36}]}, {'date': '2007-09-15', 'stage': 'First stage', 'id': 2293, 'Players': [{'dob': '1982-11-01', 'name': 'Elaine', 'id': 201416}, {'dob': '1986-07-08', 'name': 'Renata Costa', 'id': 190354}]}, {'date': '2007-09-21', 'stage': 'First stage', 'id': 2247, 'Players': [{'dob': '1982-07-06', 'name': 'Aline', 'id': 212298}, {'dob': '1974-10-03', 'name': 'Tania', 'id': 36}]}, {'date': '2007-09-27', 'stage': 'Semi-finals', 'id': 2281, 'Players': [{'dob': '1982-11-01', 'name': 'Elaine', 'id': 201416}, {'dob': '1986-07-08', 'name': 'Renata Costa', 'id': 190354}]}, {'date': '1995-06-09', 'stage': 'Quarter-finals', 'id': 2240, 'Players': [{'dob': '1982-07-06', 'name': 'Aline', 'id': 212298}, {'dob': '1974-10-03', 'name': 'Tania', 'id': 36}]}, {'date': '1995-06-05', 'stage': 'Group Matches', 'id': 2326, 'Players': [{'dob': '1982-07-06', 'name': 'Aline', 'id': 212298}, {'dob': '1974-10-03', 'name': 'Tania', 'id': 36}]}]
---
query='MATCH (n) RETURN DISTINCT labels(n) AS NodeLabels, keys(n) AS Properties' result=[{'NodeLabels': '[Person, Player, Team, Match, Game, ]', 'Properties': '[dob: date, id: int, name: string, stage: string]'}, {'NodeLabels': '[Person, Person, ]', 'Properties': '[dob: date, id: int, name: string]'}, {'NodeLabels': '[Team, ]', 'Properties': '[name: string, id: int]'}, {'NodeLabels': '[Match, Game, ]', 'Properties': '[date: date, stage: string, id: int]'}]
---
query='MATCH ()-[r]->() RETURN DISTINCT type(r) AS RelationshipTypes, keys(r) AS Properties' result=[{'RelationshipTypes': '', 'Properties': ''}, {'RelationshipTypes': 'REPRESENTED_BY', 'Properties': ['13959']}, {'RelationshipTypes': 'PLAYED_FOR', 'Properties': ['5957']}, {'RelationshipTypes': 'PLAYED_IN', 'Properties': ['6188']}, {'RelationshipTypes': 'SUBSTITUTED_IN', 'Properties': ['9040']}, {'RelationshipTypes': 'REPRESENTS', 'Properties': ['13975', '13974', '13973', '13977', '9181', '5683', '9184', '5894', '9401', '11532', '12462']}, {'RelationshipTypes': 'FOR', 'Properties': ['5894']}, {'RelationshipTypes': 'PLAYED_IN', 'Properties': ['9399']}, {'RelationshipTypes': 'SUBBED_ON', 'Properties': []}, {'RelationshipTypes': 'SUBBED_OFF', 'Properties': ['11532']}, {'RelationshipTypes': 'SUBSTITUTED_IN', 'Properties': ['9040']}, {'RelationshipTypes': '', 'Properties': ''}]
---
query='MATCH (n)-[r]->(m) RETURN labels(n) AS StartLabels, type(r) AS RelationshipType, labels(m) AS EndLabels' result=[{'StartLabels': 'Person', 'RelationshipType': 'PLAYED_IN', 'EndLabels': 'Game'}, {'StartLabels': 'Match', 'RelationshipType': 'SUBSTITUTED_IN', 'EndLabels': 'Player'}, {'StartLabels': '', 'RelationshipType': 'Represented By', 'EndLabels': 'Team'}, {'StartLabels': 'Team', 'RelationshipType': 'REPRESENTED_BY', 'EndLabels': ''}, {'StartLabels': '', 'RelationshipType': 'For', 'EndLabels': 'Person'}]
---
content='```\n{\n  "query": "MATCH (p:Person)-[:SCORED_GOAL]->(m:Match) RETURN m, collect(p) AS Players",\n  "result": [\n    {\n      "date": "2007-09-15",\n      "stage": "First stage",\n      "id": "56328"\n    },\n    [\n      {\n        "dob": "1982-07-06",\n        "name": "Aline",\n        "id": "212298"\n      },\n      {\n        "dob": "1986-07-08",\n        "name": "Renata Costa",\n        "id": "190354"\n      }\n    ],\n    {\n      "date": "2007-09-23",\n      "stage": "Final",\n      "id": "2272"\n    },\n    [\n      {\n        "dob": "1982-11-01",\n        "name": "Elaine",\n        "id": "201416"\n      }\n    ],\n    {\n      "date": "2007-09-12",\n      "stage": "First stage",\n      "id": "56331"\n    },\n    {\n      "date": "1995-06-05",\n      "stage": "Group Matches",\n      "id": "2326"\n    },\n    {\n      "date": "1995-06-09",\n      "stage": "Quarter-finals",\n      "id": "2240"\n    }\n  ]\n}\n```' additional_kwargs={} response_metadata={'model': 'llama3.2', 'created_at': '2025-02-13T15:29:03.645136Z', 'done': True, 'done_reason': 'stop', 'total_duration': 16246299042, 'load_duration': 43015125, 'prompt_eval_count': 1209, 'prompt_eval_duration': 294000000, 'eval_count': 308, 'eval_duration': 15905000000, 'message': Message(role='assistant', content='', images=None, tool_calls=None)} id='run-af6c79c3-1d7d-417c-866b-72090740b6fb-0' usage_metadata={'input_tokens': 1209, 'output_tokens': 308, 'total_tokens': 1517}
---
content='```json\n{\n  "query": "MATCH (t:Team)-[:PARTICIPATED_IN]->(tr:Tournament) RETURN t, collect(tr) AS Tournaments",\n  "result": [\n    {\n      "id": "1882881",\n      "name": "Brazil"\n    },\n    [\n      "1995-06-05",\n      "1995-06-09"\n    ],\n    [\n      "2007-09-15",\n      "2007-09-12",\n      "2007-09-23"\n    ]\n  ]\n}\n```' additional_kwargs={} response_metadata={'model': 'llama3.2', 'created_at': '2025-02-13T15:29:10.093468Z', 'done': True, 'done_reason': 'stop', 'total_duration': 6440189625, 'load_duration': 40494667, 'prompt_eval_count': 1213, 'prompt_eval_duration': 297000000, 'eval_count': 120, 'eval_duration': 6098000000, 'message': Message(role='assistant', content='', images=None, tool_calls=None)} id='run-342c2d1a-65cc-4bfa-996c-ff839e320c81-0' usage_metadata={'input_tokens': 1213, 'output_tokens': 120, 'total_tokens': 1333}
---
query='MATCH (p:Person)-[:SCORED_GOAL]->(m:Match) WITH p, count(m) AS MatchCount WHERE MatchCount >= 2 RETURN p' result=[{'name': 'Renata Costa', 'dob': '1986-07-08', 'id': '190354'}, {'name': 'Tania', 'dob': '1974-10-03', 'id': '36'}]
---
content='```\n{\n    "query": "MATCH (t1:Team)-[:PARTICIPATED_IN]->(tr:Tournament)<-[:PARTICIPATED_IN]-(t2:Team) RETURN t1, t2",\n    "result": [\n        {"id": "1882881", "name": "Brazil"},\n        {"id": "56328", "name": "No team name found"}\n    ],\n    {"id": "1882881", "name": "Brazil"},\n    {"id": "56326", "name": "No team name found"}\n}\n```\n\nNote that the second occurrence of "Brazil" is only returned once in the result. If you want to get both occurrences, you can use a UNION operation:\n\n```\nMATCH (t1:Team)-[:PARTICIPATED_IN]->(tr:Tournament)<-[:PARTICIPATED_IN]-(t2:Team) RETURN t1, t2\nUNION ALL MATCH (t1:Team)-[:PARTICIPATED_IN]->(tr:Tournament)<-[:PARTICIPATED_IN]-(t2:Team) RETURN t1, t2\n```\n\nHowever, this would return duplicate rows for each occurrence. \n\nTo get both occurrences of the same team without duplicates, you can use a DISTINCT keyword:\n\n```\nMATCH (t1:Team)-[:PARTICIPATED_IN]->(tr:Tournament)<-[:PARTICIPATED_IN]-(t2:Team) RETURN t1, t2\nWITH t1, t2, COUNT(*) OVER () AS count\nWHERE count = 1 RETURN t1, t2\n```\n\nThis would return the first occurrence of each team. To get both occurrences, you can use a UNION operation:\n\n```\nMATCH (t1:Team)-[:PARTICIPATED_IN]->(tr:Tournament)<-[:PARTICIPATED_IN]-(t2:Team) RETURN t1, t2\nUNION ALL MATCH (t1:Team)-[:PARTICIPATED_IN]->(tr:Tournament)<-[:PARTICIPATED_IN]-(t2:Team) WHERE COUNT(t1) > 1 OR COUNT(t2) > 1\n```' additional_kwargs={} response_metadata={'model': 'llama3.2', 'created_at': '2025-02-13T15:29:41.250574Z', 'done': True, 'done_reason': 'stop', 'total_duration': 24696448667, 'load_duration': 38507708, 'prompt_eval_count': 1237, 'prompt_eval_duration': 429000000, 'eval_count': 460, 'eval_duration': 24225000000, 'message': Message(role='assistant', content='', images=None, tool_calls=None)} id='run-1f56b88f-ae5a-47ad-9e19-a52b8be29dc9-0' usage_metadata={'input_tokens': 1237, 'output_tokens': 460, 'total_tokens': 1697}
---
query='MATCH (p:Person)-[:REPRESENTS]->(t:Team)-[:PARTICIPATED_IN]->(tr:Tournament) RETURN tr, collect(DISTINCT t) AS Teams, collect(DISTINCT p) AS Players' result=[{'Brazil': {'Teams': ['22', '47'], 'Players': ['49', '48']}}, {'2007-09-23': {'Teams': ['22', '47'], 'Players': ['49', '48']}}, {'2007-09-15': {'Teams': ['22', '47'], 'Players': ['49', '48']}}, {'2011-07-04': {'Teams': ['22', '47'], 'Players': ['49', '48']}}, {'2007-09-12': {'Teams': ['22', '47'], 'Players': ['49', '48']}}]
---
query='MATCH (p:Person)-[:REPRESENTS]->(t:Team) RETURN t, count(p) AS PlayerCount' result=[{'Brazil': 2, 'PlayerCount': 2}]
---
query='MATCH (p:Person)-[:SCORED_GOAL]->(m:Match)<-[:PLAYED_IN]-(t:Team) RETURN t, avg(size((p)-[:SCORED_GOAL]->())) AS AvgGoals ORDER BY AvgGoals DESC' result=[{'AvgGoals': 1.5, 't': {'name': 'Brazil'}}]
---
